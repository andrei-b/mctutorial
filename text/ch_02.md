# Chapter 2: UART
The Arduino Uno R3 communicates with your PC using UART via a USB connection, which is internally managed by a USB-to-Serial converter chip. Here's a breakdown of how it works:

**MCU UART (ATmega328P)**

Pins: TX (Digital Pin 1) and RX (Digital Pin 0)
The microcontroller uses its hardware UART (USART0) to send/receive serial data.
Baud rate and format (8N1: 8 data bits, no parity, 1 stop bit) are set using registers.

**USB-to-Serial Converter (ATmega16U2)**

Arduino Uno R3 includes a second microcontroller (ATmega16U2) flashed with firmware acting as a USB-to-Serial bridge.
This chip receives UART data from ATmega328P and sends it via USB to your PC.
Conversely, it takes USB data from the PC and sends it via UART to ATmega328P.

When you open or reopen the serial port on the PC, the DTR (Data Terminal Ready) line triggers a reset on the Arduino Uno via a capacitor. This behavior is specific to the Arduino Uno board, not to the ATmega328P or ATmega16U2 chips themselves. It is hardwired into the Unoâ€™s circuitry to allow the Arduino IDE to reset the board automatically before uploading a sketch, and there is no way to turn it off.

Some Arduino boards (like the Leonardo or Mega2560) have separate UARTs for programming and general I/O. However, on the Arduino Uno, if you need a serial port without this Arduino-specific reset behavior, your only option is to emulate UART in software.
The code accompanying this chapter allows you to dump, via UART, the contents of the Arduino RAM (SRAM) block specified by the user.
Let's have a look at UART routines which we will be using in many following examples:
```c
void uart_init(uint32_t baud) {
    // Set the baud rate
    uint16_t ubrr = (F_CPU / (16UL * baud)) - 1;
    UBRR0H = (unsigned char)(ubrr >> 8);
    UBRR0L = (unsigned char)(ubrr & 0xFF);

    // Enable receiver and transmitter
    UCSR0B = (1 << RXEN0) | (1 << TXEN0);

    // Set the frame format: 8 data bits, no parity, 1 stop bit
    UCSR0C = (1 << UCSZ01) | (1 << UCSZ00);
}
```
The 16 bit UBRR register (UBRR0H and UBRR0L bytes) is used to set the baud rate. The UART hardware uses the system clock (`F_CPU`) and divides it by a specific factor to generate the baud rate. The formula for calculating the UBRR value is:
```
     $$UBRR = F_CPU/(16*baud rate - 1)
```
   The 16 in the formula comes from the default **USART clock prescaler** in asynchronous normal mode. The UBRR value configures the UART's internal clock divider.
   This divider determines how frequently the UART hardware samples the incoming or outgoing data bits to match the desired baud rate.
    The UBRR value indirectly controls the number of clock cycles (or "ticks") between each bit in the UART communication.
    For example, at a baud rate of 9600, each bit lasts approximately 1/9600 of a second. The UBRR value ensures the UART hardware generates this timing by dividing the system clock appropriately.

